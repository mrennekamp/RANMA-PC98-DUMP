===============================================================================
                                                                               
     Virtual XMS/EMS/VCPI Memory Server ＶＥＭ４８６  Version 1.29N            
                                                  Copyright(C)1995,K.Ogino     
                                                                               
===============================================================================

★まずはじめに
     
     ダウンロードありがとうございました。
     使用する前に、このドキュメントを読んで下さるようお願いします。
     
     それから、いまのところＶＥＭ４８６は、
     
     ・動作確認はしているが、環境の違い等のため十分だとは限らない。
     ・だけれども結構な時間と手間を費やしている(^^;
     
     という理由のため、寄付希望フリーウェアとさせていただきます。
     気に入ってもらえたら、送金してくれると嬉しいです。
     
      詳しくは、このDOCの「★使用について」をお読みください。
     
     
★ＶＥＭ４８６とは？
     
     XMS/EMS/VCPI対応のメモリドライバです。特徴は、
     
     ・UMBに常駐するので、メインメモリの常駐量が０ﾊﾞｲﾄ
     　　　これがいちばんの特徴。
     
     ・UMBの常駐量は112ﾊﾞｲﾄ程度。
           
     ・XMSの速度はまあまあ(^^;で、割り込み禁止時間は非常に短い。
           普通ではXMSが文字化けの原因とはならないはず。
     
     ・ちょっとした機能がある
           HDD-BIOS移動、パレット取得、ノートパレット変換、ROMのRAM化 等々
     
     ただし、欠点は・・
     
       データ不足のためWindowsに対応していません。
     CONFIG.SYSを切り替えて使用しましょう。m(__)m
     
     
★付属のファイル

     VEM486  .HED     VEM486の紹介文
     VEM486  .DOC     このファイルです。使い方など。
     CACHE   .DOC     ＣＰＵキャッシュ関連オプションの説明です。
     SETTEI  .TXT     報告頂いた環境です。UMB設定の参考になれば幸いです。
     TROUBLE .TXT     質問、動作不都合のときに参考にして下さい。
     VEM486  .EXE     ＶＥＭ４８６の本体です。
     VEMEMM  .SYS     ＶＥＭ４８６本体のＥＭＳを利用するためのプログラム
     VEMHSB  .SYS     保護エラー時にHSBでの再起動を使用可能にします。
     VEMRSM  .SYS     レジューム対策などで使います。（特定機種）

★動作条件
     
     ・MS-DOS version5.0以上
     ・NEC PC9801/9821又は、EPSON PC386/486
     ・３８６以上のＣＰＵを搭載した機種
     ・拡張メモリが１Ｍ以上（６４Ｍまで認識）
     ・ノーマルモードにのみ対応（ハイレゾ不可）
     
     
★使い方
     
     とりあえず、使ってみたい・・・という方は、
     
     DOS=HIGH,UMB
     DEVICE=VEM486.EXE /U
     DEVICEHIGH=VEMEMM.SYS
     
     という行が先頭にあるＣＯＮＦＩＧ．ＳＹＳを作ってください。
     ほかのメモリドライバと同居は出来ませんので、ご注意ください。
     
     これで標準装備のままなら８割位の機種では動作するとおもいます。
     
     ただし、組み込んだ途端に止まる時は、HDD-BIOSをUMBにしているかもしれま
     せん。この場合は個別にUMBにする領域を指定して下さい。
     
     それでもだめなら、異常動作はHDDなどの種類にかかわっている事が多いです。
     とりあえず報告して下さると嬉しいです。
     
     
★ＣＯＮＦＩＧ．ＳＹＳ中でのオプション説明
     
     /NI     ＶＥＭ４８６の組込時の表示を最小限に抑えます。
     
     /U=xx      ＵＭＢを有効にします。
              
              例えば、ページアドレスE8からF4までをＵＭＢにしたいときは
              /U=E8-F4 と指定します。
              
              ページFAをＵＭＢにしたいときは、/U=FA と指定します。
              /U=E8-F4,FA と区切ることも出来ます。
              
              異常動作はUMBの設定ミスから起きる事が多いので注意して下さい。
              （他のROMと重なっておるなど）
              
              /U のみを指定したときには、自動的にUMBになりそうな領域を検索
              して設定します。（この場合/Mオプションとの併用は不可）
     
     /M=??:??  HDD-ROM を移動します。/m=d8:d0 とした場合は、ページD8h の HDD-
              ROM が D0h に移動されます。複数ページ指定したい場合は、
              /m=d8:d0,d9:d1,da:d2,db:d3  <--- （ちなみに)(9821Apでの設定）
              というように指定してください。
               指定する時は、できるだけ全部のHDD-ROMを連続したページに移動する
              ようにしてください。
               また、移動した領域がUMBと重ならないように注意して下さい。
     
     /E=xx      ＥＭＳのページフレームアドレスを指定します。
              指定したアドレスからの、４ページがＥＭＳになります。
              （４ページ固定です。ごめんなさい。）
              指定しない場合は、/E=C0 と同じになります。
     
     /NV      ＶＣＰＩを無効化（使用できなく)します。使われると不都合な時に
              指定してください。（通常使わないオプションです）
     
     /R=xx      通常使わないオプションですが、指定したページを強制的にRAM
              にします。ROMにパッチをあてたい場合などに使用できます。
               'ySTEALTH' （Ｍｚａｋｉ氏作） などを使用したい時などに指定し
              てください。詳しくは ySTEALTH のDOCをご覧ください。
     
     /P      これを指定すると、I/OポートのA8H,AAH,ACH,AEHによってパレットの
              取得が出来ます。これによって21用のグラフィックカッターが使える
              ようになるはずです。
              また、9821シリーズでは指定する必要はありません。
     
     /PA      パレット取得のほかI/OポートのA4H,A6Hも読み出せるようにします。
              ただし頻繁に表・裏画面を切り替えているものは動作が遅くなる可能
              性があります。
              これも、9821シリーズでは指定する必要はありません
     
     /N       これを指定すると、ノートパソコンの白黒液晶でのグラフィック画面
              を見易くするために、4096色中16色アナログカラーパレットを8階調
              のパレットに変換します。
               また、これを指定した時は、パレットの読み出しが出来ます。（/Pと
              同様です）
     
     
★コマンドラインでのオプション
     
     /V+      これも通常使いませんが、ＶＣＰＩを有効化／無効化します。
     /V-     CONFIG.SYS内で/NVを指定した時などにも使用出来ます。
     
     /N+      CONFIG.SYS中で/Nを指定してノートパレット機能を有効にした時、
     /N-     この機能を停止／再開するためのオプションです。
     
     
        キャッシュ関連のオプションについては、CACHE.DOCの方をご覧ください。
     
     
★VEMEMM.SYS について
     
     VEM486のEMS機能を利用するために必要です。
     
     VEM486.EXEのみではXMSドライバだけになってしまいますので、
     必ず組み込んでください。
     
     DEVICE = VEM486.EXE   <- オプションは各自で指定してください
     
     の後、
     
     DEVICEHIGH = VEMEMM.SYS  <- オプションはありません
     
     というようにします。
     
     VEMEMMはVEM486のあとのどの場所で組み込んでもかまいませんので、
     UMBのツール類を使用して組み込む事も出来ます。
     
     ただし、組み込む前には、VCPI,EMS メモリが使えません。
     
     
★VEMHSB.SYSについて
     
     一般保護フォールトなどが発生してしまった場合でも、リターンキーで
     HSBによる高速再起動が使えるようにします。
     
     使い方は、CONFIG.SYS中でHSBの組込み後に
     
     DEVICE = VEMHSB.SYS
     
     というふうに登録します。
     
     ただし、HSB側のオプションによっては認識しない事があります。
     
     VEMHSB.SYSがないときに保護フォールトが出ても、リターンキーで再起動が
     出来ますが、リセットを押したのと同等になります。
     
     
★VEMRSM.SYSについて
     
     これは、ちょっと古めのノートパソコンでレジュームが使えなくなったり、
     HSB CX+,HSB CX- などでキャッシュ制御を行いたい時などに使用します。
     
     
     具体的には、int 1fhの 8b00h/8c00hを使用可能にし、仮想８６モードの
     解除が出来るようにします。
     
     使い方は、CONFIG.SYS中のVEM486を組み込んだ後に、
     
     DEVICE = VEMRSM.SYS          <- オプションはありません。
     
     というふうに登録します。
     
     ただし、メインメモリにしか常駐しませんので、とくに不都合がない時は
     使う必要はありません。
     
     
★ＵＭＢの設定注意
     
     UMB,MOVE-HDD-BIOSの設定などを、他のメモリドライバの設定を参考に
     する場合の注意です。
     
     TDPMIの場合は、問題ありませんが、VMM386の場合は、HDD-BIOSの先頭の
     ページしか分からないので注意して下さい。
     この場合は、LUMB /MAPなどの情報を参考にして設定すれば良いと思います。
     
     ただし、LUMBではHDD-BIOSとして使用していても一部しか分からず、使用して
     いない領域として表示される事も多い様です。
     
     また、TDPMIに付属しているOPT98では問題ないようです。
     
     
★使用について
     
     このプログラムは、寄付希望フリーウェアとさせていただきます。
     
     私の費やした時間、手間、それと本代(^^;を評価していただければいいなと
     考えています。
     特に大きな特典はありませんがバグ、質問などへの対応は早くなるはずです。
     
     お手数ですがよろしければ送金してくださるよう、お願いします。
     
     ●寄付金：\800 程度（送料込みで可）
     
     ●送り先（銀行振込）
     
     さくら銀行  港南台支店
     銀行番号−店番号−口座番号： 0002 - 227 - 5470645 （普通預金）
     名義：荻野 晃史 ( ｵｷﾞﾉ ｺｳｼﾞ)
     
     ●その後
     
     どなたに送金していただいたか分からないので、確認のため、振り込んだ日付
     をご記入の上、作者宛のメールをお願いします。
     
     連絡先（連絡がつきやすい順）
     
     ZOBstation          ZOB14914   0466-80-1045
     ゆいＮＥＴ          YUI07675   0467-44-0643
     Nifty-Serve         VYC12172
     ＰＣ−ＶＡＮ        NDN88999
     ＹＭＯ              YMO22551   045-831-8819
     暮里研究所          KURE0086   0742-22-9131
     
     なお、一人で数台パソコンを所有している場合でも、一口で結構です。
     営利目的で使用する場合は、この限りではありません。メールにてご連絡
     下さい。
     
     
★今後の予定
     
     とにかくまずはバグ全廃ですね。それから機能アップしていきたいです。
     
     ほかにも、ご要望があれば出来る限り（難しくなければ）対処したいと
     思っています。
     
     
★ちょっと技術的なこと
     
      /Rオプションというのがあります。これは指定されたところにメモリをマップ
     して、元のところにあったデータをコピーしています。
     
      /Rと/M,/Uで同じページを指定しないでください。
     ただし、/Uと/E、/Rと/Eは重ねる事は出来ます。
     
      /Mオプションでは、対象ROM中にパッチの必要があった場合、そこをRAMにして
     パッチを当てます。この機能は /NOROMPATCH オプションにより停止出来ます。
     
      Cx486DX2、Cx5x86への載せ替え機種でライトバックONにしたときに、HSB使用
     不可能であった環境でも、HSBの再起動時にライトバックOFFにしますので、
     使用出来ると思います。
     
      それから、ＥＭＳドライバもＸＭＳドライバもプロテクトメモリ中に常駐して
     メインメモリに常駐しているのは、呼び出す部分だけです。
     
      今のところVDS(Virtual DMA Specification)に対応していません。
      できれば対応したいと思っています。なんせデータがinterrupt listのみ
     なので。詳しい資料ありませんか？（英語でも可です）
     
      DMA関係については多重DMAを80000H-FFFFFHの領域で行った場合の動作、
     H98のNESAバス、またはPCIバスを使用しているSCSIなどの動作に不都合が
     でるかもしれません。ただ、この場合UMBを作らなければ大丈夫みたいです。
     
      バンクメモリ実装時はキャッシュフラッシュするようにしてあります。ただし、
     これによる効果は不明です。(^^;
     
      CR0-3レジスタは、読み込みは出来ますが、CR0レジスタのCDﾋﾞｯﾄとNWﾋﾞｯﾄ以外
     は書き換えても変化しません。
     
     また、TRレジスタ、DRレジスタも読み書きは出来ますが、内容の変更はされま
     せん。
     
      HLT命令をエミュレートしていますので、対応しているＣＰＵならば簡単に
     パワーセーブ機能が実現出来ます。
     
     VEM486専用のファンクションについてはサンプルプログラムを参考にして下さい。
     
     
★ちょっと一言
     
     このＶＥＭ４８６を3月下旬に公開し、わりと反響が大きくて嬉しいのですが、
     その反面バグなどの不都合な点も浮き上がってきました。
     
     version 1.01 など、初めのうちは随分と途中で止まったりして相当不安定でし
     たが、最近のは随分と安定して、よくなっている気がします。
     
     開発に協力して下さった、たくさんの方々に感謝しています。
     よかったらこれからもよろしくお願いします。m(__)m
     
     
★転載その他
  
   このプログラムは、寄付希望フリーウェアとします。
  
   著作権は作者である、K.Ogino（荻野 晃史）が所有しています。
   このプログラムにより不利益が生じた場合でも作者は一切責任を負いません。
  
   転載については、このバージョンは不可とします。
   商利用、営利目的の場合は私宛のメールにて確認して下さい。
  
  
   質問、意見、感想等ありましたら、お気軽にご連絡下さい。
  
   バグレポートも歓迎します。
   ただし、必ずしも対応するとは（出来るとは）限りません。
  
   また、できるだけ他の常駐物、UMBの設定など調べてからにして下さい。
  
   常駐物の相性などは結構あります。また、他のメモリドライバで試してみて不都合が
  出るかどうかも試してみるのも効果的です。
  
   VEM486ではどうも異常動作するというような物があったら、送ってくれると嬉しい
   です。現物がないとどうしようもありませんので。
  
   また、バグが再現出来るなら、ほとんど修正出来ると思います。
  
  
  新バージョンが出たときには、そちらのほうを使っていただくよう、お願いします。
  
  サポートはZOBstation の junk.soft のＶＥＭ４８６というノートで行っています。
  
       読みづらいこの文章を読んで下さってありがとうございます。
  
                                                         K.Ogino / 荻野 晃史
